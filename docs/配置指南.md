# Nanobot 配置指南

本指南说明配置文件位置、常用管理命令，以及“机器人是否能修改配置”。

## 基础命令

- 查看配置：`nanobot config list`
- 设置配置项：`nanobot config set agents.defaults.model "gemini-3-flash"`
- 设置单轮工具调用上限：`nanobot config set brain.max_total_tool_calls 30`
- 配置体检：`nanobot doctor`
- 运行体检：`nanobot health`

## 配置文件位置

- 默认配置目录：`.home/`
- 默认配置文件：`.home/config.json`
- 默认日志文件：`.home/gateway.log`、`.home/audit.log`
- 工具配置目录：`.home/tool_configs/`

工具配置规则：

- 读取与写入都统一使用 `.home/tool_configs/`。

也可以通过环境变量切换目录：

```bash
export NANOBOT_HOME="/path/to/data_dir"
nanobot gateway
```

## 推荐启动与运维命令

```bash
cd /Users/liusong/Downloads/nanobot
./scripts/run_gateway.sh
```

```bash
cd /Users/liusong/Downloads/nanobot
NANOBOT_HOME=$PWD/.home .venv/bin/nanobot stop
NANOBOT_HOME=$PWD/.home .venv/bin/nanobot restart
NANOBOT_HOME=$PWD/.home .venv/bin/nanobot health
```

## 机器人能不能改 `.home/config.json`

可以，但要看运行上下文和权限。

- 在当前 Codex 开发会话中：可以直接修改（与仓库同机同目录权限）。
- 在 Nanobot 聊天通道中：通常也可以修改，但前提是工具权限允许访问 `.home/`。

关键条件：

- `tools.restrict_to_workspace = false` 时，工具不限制在 `workspace/`，可访问 `.home/`。
- `tools.restrict_to_workspace = true` 时，工具会限制在 `workspace/`，此时不能直接改 `.home/config.json`。

推荐做法：

- 优先使用 `nanobot config set ...` 修改配置，避免手写 JSON 造成格式错误。
- 需要批量改动时，再让机器人改 `config.json`，改完立即执行 `nanobot health` 校验。

## 相关文档

- [项目结构](项目结构.md)
- [路线图](路线图.md)
